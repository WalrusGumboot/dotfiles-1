var app={};app.loadReason="startup",app.version=function(){return chrome.runtime.getManifest().version},app.homepage=function(){return""},app.tab={open:function(a){chrome.tabs.create({url:a,active:!0})}},chrome.runtime.onMessage.addListener(function(b,a,c){"top"===b.message&&c(a.tab.url),"createScheme"===b.message&&(c({schemeName:b.schemeName,schemeParams:b.schemeParams}),chrome.storage.local.get({colorSchemes:{}},function(d){var a=d.colorSchemes;a[b.schemeName]=b.schemeParams,chrome.storage.local.set({colorSchemes:a,activeScheme:b.schemeName||""},function(){})})),"renameScheme"===b.message&&chrome.storage.local.get({colorSchemes:{}},function(d){const a=d.colorSchemes,e={...d.colorSchemes[b.prevSchemeName]};delete a[b.prevSchemeName],a[b.newSchemeName]=e,chrome.storage.local.set({colorSchemes:a},function(){c({schemeName:b.newSchemeName,colorSchemes:d.colorSchemes})})}),"deleteScheme"===b.message&&chrome.storage.local.get({colorSchemes:{}},function(d){const a={},e=d.colorSchemes;delete e[b.schemeToDelete],a.colorSchemes=e,b.isActive&&(a.activeScheme=""),chrome.storage.local.set(a,function(){c({colorSchemes:d.colorSchemes})})}),"setActiveScheme"===b.message&&(c({activeScheme:b.schemeToActivate}),chrome.storage.local.get({activeScheme:""},function(){chrome.storage.local.set({activeScheme:b.schemeToActivate},function(){})}))}),app.storage=function(){var a={};return chrome.storage.onChanged.addListener(function(){chrome.storage.local.get(null,function(b){a=b})}),window.setTimeout(function(){chrome.storage.local.get(null,function(b){a=b;var c=document.createElement("script");c.src="/js/common.js",document.body.appendChild(c)})},300),{read:function(b){return a[b]},write:function(b,c){var d={};a[b]=c,d[b]=c,chrome.storage.local.set(d)}}}(),app.button=function(){var a;return chrome.browserAction.onClicked.addListener(function(){a&&a()}),{onCommand:function(b){a=b},set icon(a){chrome.browserAction.setIcon(a)},set label(a){chrome.browserAction.setTitle({title:a})}}}();var config={};config.welcome={set open(a){app.storage.write("support",a)},get version(){return app.storage.read("version")},set version(a){app.storage.write("version",a)},get open(){var a=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");return app.storage.read("support")===void 0?!a:app.storage.read("support")}},config.addon={set state(a){app.storage.write("state",a)},get state(){return app.storage.read("state")===void 0?"light":app.storage.read("state")}},config.addon.state="dark";const CONFIG_URL="https://dkmode.net/api/";chrome.webNavigation.onHistoryStateUpdated.addListener(a=>{0===a.frameId&&chrome.tabs.query({active:!0},b=>{chrome.tabs.sendMessage(b[0].id,{action:"URLChanged",url:a.url},()=>{})})});